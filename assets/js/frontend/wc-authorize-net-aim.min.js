/*!
 * WooCommerce Authorize.net AIM Gateway
 * Version 3.0
 *
 * Copyright (c) 2011-2015, SkyVerge, Inc.
 * Licensed under the GNU General Public License v3.0
 * http://www.gnu.org/licenses/gpl-3.0.html
 */
jQuery(document).ready(function(a){"use strict";function b(b){if(b.is(".processing"))return!1;var d=a(".payment_method_authorize_net_aim"),f=[],g=d.find(".js-wc-payment-gateway-account-number").val(),h=d.find(".js-wc-payment-gateway-csc").val(),i=d.find(".js-wc-payment-gateway-card-exp-month").val(),j=d.find(".js-wc-payment-gateway-card-exp-year").val();g=g.replace(/-|\s/g,""),g?((g.length<12||g.length>19)&&f.push(authorize_net_aim_params.card_number_length_invalid),/\D/.test(g)&&f.push(authorize_net_aim_params.card_number_digits_invalid),c(g)||f.push(authorize_net_aim_params.card_number_invalid)):f.push(authorize_net_aim_params.card_number_missing);var k=(new Date).getFullYear();return(/\D/.test(i)||/\D/.test(j)||i>12||1>i||k>j||j>k+20)&&f.push(authorize_net_aim_params.card_exp_date_invalid),"undefined"!=typeof h&&(h?(/\D/.test(h)&&f.push(authorize_net_aim_params.cvv_digits_invalid),(h.length<3||h.length>4)&&f.push(authorize_net_aim_params.cvv_length_invalid)):f.push(authorize_net_aim_params.cvv_missing)),f.length>0?(e(b,f),!1):(d.find(".js-wc-payment-gateway-account-number").val(g),!0)}function c(a){var b,c,d,e=0;for(b=0,c=a.length;c-1>b;b++)d=parseInt(a.substr(c-(b+2),1)*(2-b%2),10),e+=10>d?d:d-9;return parseInt(a.substr(c-1),10)===(10-e%10)%10}function d(b){if(b.is(".processing"))return!1;var c=a(".payment_method_authorize_net_aim_echeck"),d=[],f=c.find(".js-wc-payment-gateway-routing-number").val(),g=c.find(".js-wc-payment-gateway-account-number").val();return f?(9!==f.length&&d.push(authorize_net_aim_params.routing_number_length_invalid),/\D/.test(f)&&d.push(authorize_net_aim_params.routing_number_digits_invalid)):d.push(authorize_net_aim_params.routing_number_missing),g?((g.length<5||g.length>17)&&d.push(authorize_net_aim_params.account_number_length_invalid),/\D/.test(g)&&d.push(authorize_net_aim_params.account_number_invalid)):d.push(authorize_net_aim_params.account_number_missing),d.length>0?(e(b,d),!1):(c.find(".js-wc-payment-gateway-account-number").val(g),!0)}function e(b,c){a(".woocommerce-error, .woocommerce-message").remove(),b.prepend('<ul class="woocommerce-error"><li>'+c.join("</li><li>")+"</li></ul>"),b.removeClass("processing").unblock(),b.find(".input-text, select").blur(),a("html, body").animate({scrollTop:b.offset().top-100},1e3)}var f=a("form.checkout");if(f.length)f.bind("checkout_place_order_authorize_net_aim",function(){return b(a(this))}),f.bind("checkout_place_order_authorize_net_aim_echeck",function(){return d(a(this))});else{var g=a("#order_review input[name=payment_method]:checked").val();a("form#order_review").submit(function(){return"authorize_net_aim"===g?b(a(this)):"authorize_net_aim_echeck"===g?d(a(this)):void 0})}a("body").bind("updated_checkout",function(){a("img.js-wc-authorize-net-aim-echeck-account-help").click(function(){a(this).closest(".payment_method_authorize_net_aim_echeck").find(".sample-check").is(":visible")||a(this).closest(".payment_method_authorize_net_aim_echeck").find(".sample-check").slideDown()})})});
